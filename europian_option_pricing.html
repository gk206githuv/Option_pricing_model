<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>European Option Pricing Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">European Option Pricing Dashboard</h1>
            <p class="text-md text-gray-600 mt-2">Compare Black-Scholes, Monte Carlo, and Binomial Tree models in real-time.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Input Parameters Column -->
            <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl font-bold mb-6 border-b pb-3">Model Inputs</h2>

                <div class="space-y-6">
                    <!-- Stock Price -->
                    <div>
                        <div class="slider-label mb-1">
                            <label for="stockPrice" class="font-medium">Stock Price (S)</label>
                            <span id="stockPriceValue" class="font-semibold text-indigo-600">100.00</span>
                        </div>
                        <input type="range" id="stockPrice" min="1" max="300" step="1" value="100" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <!-- Strike Price -->
                    <div>
                        <div class="slider-label mb-1">
                            <label for="strikePrice" class="font-medium">Strike Price (K)</label>
                            <span id="strikePriceValue" class="font-semibold text-indigo-600">100.00</span>
                        </div>
                        <input type="range" id="strikePrice" min="1" max="300" step="1" value="100" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <!-- Time to Maturity -->
                    <div>
                        <div class="slider-label mb-1">
                            <label for="maturity" class="font-medium">Time to Maturity (T, years)</label>
                            <span id="maturityValue" class="font-semibold text-indigo-600">1.00</span>
                        </div>
                        <input type="range" id="maturity" min="0.1" max="5" step="0.05" value="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <!-- Risk-Free Rate -->
                    <div>
                        <div class="slider-label mb-1">
                            <label for="riskFreeRate" class="font-medium">Risk-Free Rate (r, %)</label>
                            <span id="riskFreeRateValue" class="font-semibold text-indigo-600">5.00</span>
                        </div>
                        <input type="range" id="riskFreeRate" min="0" max="20" step="0.1" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <!-- Volatility -->
                    <div>
                        <div class="slider-label mb-1">
                            <label for="volatility" class="font-medium">Volatility (Ïƒ, %)</label>
                            <span id="volatilityValue" class="font-semibold text-indigo-600">20.00</span>
                        </div>
                        <input type="range" id="volatility" min="1" max="100" step="0.5" value="20" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>

                    <!-- Dividend Yield -->
                    <div>
                        <div class="slider-label mb-1">
                            <label for="dividendYield" class="font-medium">Dividend Yield (q, %)</label>
                            <span id="dividendYieldValue" class="font-semibold text-indigo-600">0.00</span>
                        </div>
                        <input type="range" id="dividendYield" min="0" max="10" step="0.1" value="0" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                </div>
            </div>

            <!-- Results Column -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Black-Scholes Model -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">1. Black-Scholes-Merton Model</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-center">
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <p class="text-sm font-medium text-green-700">Call Price</p>
                            <p id="bsmCall" class="text-2xl font-semibold text-green-900">-</p>
                        </div>
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <p class="text-sm font-medium text-red-700">Put Price</p>
                            <p id="bsmPut" class="text-2xl font-semibold text-red-900">-</p>
                        </div>
                    </div>
                </div>

                <!-- Monte Carlo Simulation -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">2. Monte Carlo Simulation</h3>
                    <p class="text-xs text-gray-500 mb-4 -mt-2">Based on 10,000 simulations.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-center">
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <p class="text-sm font-medium text-green-700">Call Price</p>
                            <p id="mcCall" class="text-2xl font-semibold text-green-900">-</p>
                        </div>
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <p class="text-sm font-medium text-red-700">Put Price</p>
                            <p id="mcPut" class="text-2xl font-semibold text-red-900">-</p>
                        </div>
                    </div>
                </div>

                <!-- Binomial Tree Model -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-4 text-gray-800">3. Binomial Tree (CRR)</h3>
                    <p class="text-xs text-gray-500 mb-4 -mt-2">Based on 100 steps.</p>
                     <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-center">
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <p class="text-sm font-medium text-green-700">Call Price</p>
                            <p id="btCall" class="text-2xl font-semibold text-green-900">-</p>
                        </div>
                        <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                            <p class="text-sm font-medium text-red-700">Put Price</p>
                            <p id="btPut" class="text-2xl font-semibold text-red-900">-</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- UTILITY FUNCTIONS ---
        
        // Standard Normal Cumulative Distribution Function (CDF) using the Error Function
        function standardNormalCDF(x) {
            return (1 - erf(-x / Math.sqrt(2))) / 2;
        }

        // Error Function (erf) approximation
        function erf(x) {
            const a1 = 0.254829592;
            const a2 = -0.284496736;
            const a3 = 1.421413741;
            const a4 = -1.453152027;
            const a5 = 1.061405429;
            const p = 0.3275911;

            const sign = (x >= 0) ? 1 : -1;
            x = Math.abs(x);

            const t = 1.0 / (1.0 + p * x);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);

            return sign * y;
        }
        
        // --- MODEL IMPLEMENTATIONS ---

        // 1. Black-Scholes-Merton Model
        function blackScholes(S, K, T, r, q, sigma) {
            const d1 = (Math.log(S / K) + (r - q + 0.5 * sigma * sigma) * T) / (sigma * Math.sqrt(T));
            const d2 = d1 - sigma * Math.sqrt(T);

            const callPrice = S * Math.exp(-q * T) * standardNormalCDF(d1) - K * Math.exp(-r * T) * standardNormalCDF(d2);
            const putPrice = K * Math.exp(-r * T) * standardNormalCDF(-d2) - S * Math.exp(-q * T) * standardNormalCDF(-d1);
            
            return { call: callPrice, put: putPrice };
        }

        // 2. Monte Carlo Simulation
        function monteCarlo(S, K, T, r, q, sigma, simulations) {
            let callPayoffSum = 0;
            let putPayoffSum = 0;

            for (let i = 0; i < simulations; i++) {
                // Generate a standard normal random variable using Box-Muller transform
                const u1 = Math.random();
                const u2 = Math.random();
                const z = Math.sqrt(-2.0 * Math.log(u1)) * Math.cos(2.0 * Math.PI * u2);

                const ST = S * Math.exp((r - q - 0.5 * sigma * sigma) * T + sigma * Math.sqrt(T) * z);
                
                callPayoffSum += Math.max(0, ST - K);
                putPayoffSum += Math.max(0, K - ST);
            }

            const callPrice = (callPayoffSum / simulations) * Math.exp(-r * T);
            const putPrice = (putPayoffSum / simulations) * Math.exp(-r * T);

            return { call: callPrice, put: putPrice };
        }

        // 3. Binomial Tree (Cox-Ross-Rubinstein) Model
        function binomialTree(S, K, T, r, q, sigma, steps) {
            const dt = T / steps;
            const u = Math.exp(sigma * Math.sqrt(dt));
            const d = 1 / u;
            const p = (Math.exp((r - q) * dt) - d) / (u - d);
            
            // Initialize option values at maturity
            let optionValues = new Array(steps + 1);
            for (let i = 0; i <= steps; i++) {
                const stockPriceAtNode = S * Math.pow(u, i) * Math.pow(d, steps - i);
                optionValues[i] = {
                    call: Math.max(0, stockPriceAtNode - K),
                    put: Math.max(0, K - stockPriceAtNode)
                };
            }

            // Work backwards through the tree
            for (let step = steps - 1; step >= 0; step--) {
                for (let i = 0; i <= step; i++) {
                     const callValue = Math.exp(-r * dt) * (p * optionValues[i + 1].call + (1 - p) * optionValues[i].call);
                     const putValue = Math.exp(-r * dt) * (p * optionValues[i + 1].put + (1 - p) * optionValues[i].put);
                     optionValues[i] = { call: callValue, put: putValue };
                }
            }

            return { call: optionValues[0].call, put: optionValues[0].put };
        }


        // --- DOM MANIPULATION & EVENT LISTENERS ---

        document.addEventListener('DOMContentLoaded', () => {
            const inputs = {
                stockPrice: document.getElementById('stockPrice'),
                strikePrice: document.getElementById('strikePrice'),
                maturity: document.getElementById('maturity'),
                riskFreeRate: document.getElementById('riskFreeRate'),
                volatility: document.getElementById('volatility'),
                dividendYield: document.getElementById('dividendYield')
            };

            const values = {
                stockPrice: document.getElementById('stockPriceValue'),
                strikePrice: document.getElementById('strikePriceValue'),
                maturity: document.getElementById('maturityValue'),
                riskFreeRate: document.getElementById('riskFreeRateValue'),
                volatility: document.getElementById('volatilityValue'),
                dividendYield: document.getElementById('dividendYieldValue')
            };

            const outputs = {
                bsmCall: document.getElementById('bsmCall'),
                bsmPut: document.getElementById('bsmPut'),
                mcCall: document.getElementById('mcCall'),
                mcPut: document.getElementById('mcPut'),
                btCall: document.getElementById('btCall'),
                btPut: document.getElementById('btPut'),
            };

            function updateCalculations() {
                // Get values from sliders
                const S = parseFloat(inputs.stockPrice.value);
                const K = parseFloat(inputs.strikePrice.value);
                const T = parseFloat(inputs.maturity.value);
                const r = parseFloat(inputs.riskFreeRate.value) / 100;
                const sigma = parseFloat(inputs.volatility.value) / 100;
                const q = parseFloat(inputs.dividendYield.value) / 100;

                // Update display values
                values.stockPrice.textContent = S.toFixed(2);
                values.strikePrice.textContent = K.toFixed(2);
                values.maturity.textContent = T.toFixed(2);
                values.riskFreeRate.textContent = (r * 100).toFixed(2);
                values.volatility.textContent = (sigma * 100).toFixed(2);
                values.dividendYield.textContent = (q * 100).toFixed(2);

                // Run calculations
                const bsmResult = blackScholes(S, K, T, r, q, sigma);
                const mcResult = monteCarlo(S, K, T, r, q, sigma, 10000); // 10k simulations
                const btResult = binomialTree(S, K, T, r, q, sigma, 100); // 100 steps
                
                // Update output fields
                outputs.bsmCall.textContent = `$${bsmResult.call.toFixed(4)}`;
                outputs.bsmPut.textContent = `$${bsmResult.put.toFixed(4)}`;
                outputs.mcCall.textContent = `$${mcResult.call.toFixed(4)}`;
                outputs.mcPut.textContent = `$${mcResult.put.toFixed(4)}`;
                outputs.btCall.textContent = `$${btResult.call.toFixed(4)}`;
                outputs.btPut.textContent = `$${btResult.put.toFixed(4)}`;
            }

            // Add event listeners to all sliders
            Object.values(inputs).forEach(input => {
                input.addEventListener('input', updateCalculations);
            });

            // Initial calculation on page load
            updateCalculations();
        });
    </script>

</body>
</html>
